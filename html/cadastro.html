<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="../styles/cadastro.css" />
    <link rel="shortcut icon" href="../src/logo png.png" />
    <title>Cadastro</title>
</head>

<body>
    <header class="navbar">
        <img src="../src/logo png.png" alt="logo" class="logoheader" />
        <div class="menu">
            <a href="home.html">
                <p>Início</p>
            </a>
            <a href="simulador.html">
                <p>Simulador</p>
            </a>
            <a href="sobreNos.html">
                <p>Sobre nós</p>
            </a>
        </div>
        <div class="cadastro">
            <a href="login.html">
                <p>Login</p>
            </a>
            <div class="c">
                <a href="cadastro.html">
                    <p class="cadastrar">Cadastro</p>
                </a>
            </div>
        </div>
    </header>

    <div class="conteudo">
        <div class="entradas">
            <h2>Cadastro</h2>
            <p>Codigo de ativação</p>
            <img src="../src/codigo-de-barras.png" alt="" />
            <input type="text" id="iptCodigoAti" placeholder="ex: 9E345RT09" />
            <div id="msg"></div>
            <p>Nome</p>
            <img src="../src/pessoa.png" alt="" />
            <input type="text" id="iptNome" placeholder="Ex: Cesar" />
            <div id="msg2"></div>
            <p>Email</p>
            <img src="../src/o-email.png" alt="" />
            <input type="text" id="iptEmail" placeholder="Ex: agrosense@gmail.com" />
            <div id="msg3"></div>
            <p>Senha</p>
            <img src="../src/cadeado-trancado.png" alt="imagem do cadeado" />
            <input type="password" id="iptSenha" onkeyup="mostrarSenha()" placeholder="Ex: @groSense123" />
            <div class="validacao">
                <p id="p1"></p>
                <p id="p2"></p>
                <p id="p3"></p>
                <p id="p4"></p>
                <p id="p5"></p>
            </div>
            <p>Confirmar Senha</p>
            <img src="../src/cadeado-trancado.png" alt="imagem do cadeado" />
            <input type="password" id="iptCheckSenha" placeholder="Ex: @groSense123" />
            <div id="msg4"></div>
            <p>Telefone</p>
            <img src="../src/telefone.png" alt="" />
            <input type="number" id="iptTelefone" placeholder="Ex: 119801008418" />
            <div id="msg5"></div>
            <p>CPF</p>
            <img src="../src/cpf.png" alt="" />
            <input type="number" id="iptCPF" placeholder="Ex: 32145698701" />
            <div id="msg6"></div>

            <div class="botao c">
                <button onclick="cadastrar()" class="botao">Cadastrar</button>
            </div>
        </div>
    </div>

    <footer class="rodape">
        <div class="rodape_bordao">
            <img src="../src/logo branca.png" alt="logo" class="logofooter" />
            <p>Tecnologia que nasce da terra</p>
        </div>
        <div class="rodape_contato">
            <p>Contato</p>

            <div>
                <img src="../src/whatsapp.png" alt="logoWhatsapp" />
                <a href=""><span>+55 (11) 9999-9999</span></a>
            </div>
            <div>
                <img src="../src/email.png" alt="logoEmail" />
                <a href=""><span>agrosense@agrosense.com</span></a>
            </div>
        </div>
        <div class="rodape_redes">
            <p>Redes Sociais</p>
            <div>
                <img src="../src/youtube.png" alt="logoYoutube" />
                <img src="../src/instagram.png" alt="logoInstagram" />
                <img src="../src/linkedin.png" alt="logoLinkedin" />
            </div>
        </div>
        <div class="rodape_empresas">
            <div>
                <p>Empresas Parceiras</p>
            </div>
            <div class="empresas">
                <a href="">
                    <p>Empresa Parceira 1</p>
                </a>
                <a href="">
                    <p>Empresa Parceira 2</p>
                </a>
                <a href="">
                    <p>Empresa Parceira 3</p>
                </a>
            </div>
        </div>
    </footer>
</body>

<script>

    function cadastrar() {
        var codigoAtivacao = iptCodigoAti.value
        var nome = iptNome.value
        var email = iptEmail.value
        var senha = iptSenha.value
        var confirmarSenha = iptCheckSenha.value
        var telefone = Number(iptTelefone.value)
        var cpf = Number(iptCPF.value)
        mostrarSenha()

        msg.innerHTML = ''
        msg2.innerHTML = ''
        msg3.innerHTML = ''
        msg4.innerHTML = ''
        msg5.innerHTML = ''
        msg6.innerHTML = ''

        if (codigoAtivacao == ``) {
            msg.innerHTML = `Preencha o campo Código de ativação`
        } if (nome == ``) {
            msg2.innerHTML = `Preencha o campo nome`
        } if (email == ``) {
            msg3.innerHTML = `Preencha o campo email`
        } if (confirmarSenha == ``) {
            msg4.innerHTML = `Preencha o campo Confirmar Senha`
        } if (telefone == 0) {
            msg5.innerHTML = `Preencha o campo telefone`
        } if (cpf == 0) {
            msg6.innerHTML = `Preencha o campo CPF`
        }
        else if (codigoAtivacao.length > 9 || codigoAtivacao.length < 9) {
            msg.innerHTML = 'O campo código de ativação tem que ter 9 dígitos!'
        } else if (telefone % 1 != 0 || telefone < 0 || telefone > 99999999999) {
            msg5.innerHTML = `No campo telefone não é necessário os caracteres especiais("-","+") e lembre que o número tem que conter 11 caracteres.`
        } else if (telefone <= 11111111111) {
            msg5.innerHTML = 'No campo telefone tem que ter mais de 11 caracteres'
        } else if (cpf % 1 != 0 || cpf < 0 || cpf > 99999999999) {
            msg6.innerHTML = `No campo CPF não pode ser maior que 11 caracteres`
        } else if (cpf <= 11111111111) {
            msg6.innerHTML = 'No campo CPF não pode ser menor que 11 caracteres'
        } else if (!(email.includes(`@`))) {
            msg3.innerHTML = `Seu email não contém "@"`
        } else if (!(email.includes(`.`))) {
            msg3.innerHTML = `Seu email não contém "."`
        } else if (senha.length < 8) {
            msg4.innerHTML = 'No campo senha tem que ter mais que 8 caracteres'
        } else if (senha == senha.toUpperCase()) {
            msg4.innerHTML = 'A senha não contém letras minúsculas'
        } else if (senha == senha.toLowerCase()) {
            msg4.innerHTML = 'A senha não contém letras maiúsculas'
        } else if (!(senha.includes(`0`)) && !(senha.includes(`1`)) && !(senha.includes(`2`)) && !(senha.includes(`3`)) && !(senha.includes(`4`)) && !(senha.includes(`5`)) && !(senha.includes(`6`)) && !(senha.includes(`7`)) && !(senha.includes(`8`)) && !(senha.includes(`9`))) {
            msg4.innerHTML = 'A senha tem que ter pelo menos um número (0 a 9)'
        } else if (!(senha.includes(`!`)) && !(senha.includes(`@`)) && !(senha.includes(`#`)) && !(senha.includes(`$`)) && !(senha.includes(`%`))) {
            msg4.innerHTML = `A senha tem que ter pelo menos um caracter especial (!, @, #, $, %)`
        }
        else if (confirmarSenha != senha) {
            msg4.innerHTML = `Verifique se as senhas estão iguais`
        } else {
            alert(`Cadastro efetuado com sucesso!! Agora faça seu login!!`)
            fetch("/usuarios/cadastrar", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                },
                body: JSON.stringify({
                    nomeServer: nome,
                    emailServer: email,
                    senhaServer: senha,
                    cpfServer: cpf,
                    codigoAtivacaoServer: codigoAtivacao
                }),
            })
                .then(function (resposta) {
                    console.log("resposta: ", resposta);

                    if (resposta.ok) {

                        setTimeout(() => {
                            window.location = "login.html";
                        }, "2000");

                    }
                })
        }
    }

    function mostrarSenha() {
        var senha = iptSenha.value
        if (senha.length < 8) {
            p1.innerHTML = `<span style="color: red;">A senha tem que conter pelo menos 8 caracteres</span><br>`
        } if (senha.length >= 8) {
            p1.innerHTML = `<span style="color: green;">A senha tem que conter pelo menos 8 caracteres</span><br>`
        } if (senha == senha.toUpperCase()) {
            p2.innerHTML = `<span style="color: red;">A senha tem que conter letras minúsculas</span><br>`
        } if (senha != senha.toUpperCase()) {
            p2.innerHTML = `<span style="color: green;">A senha tem que conter letras minúsculas</span><br>`
        } if (senha == senha.toLowerCase()) {
            p3.innerHTML = `<span style="color: red;">A senha tem que conter letras maiúsculas</span><br>`
        } if (senha != senha.toLowerCase()) {
            p3.innerHTML = `<span style="color: green;">A senha tem que conter letras maiúsculas</span><br>`
        } if (!(senha.includes(`!`)) || !(senha.includes(`@`)) || !(senha.includes(`#`)) || !(senha.includes(`$`)) || !(senha.includes(`%`))) {
            p4.innerHTML = `<span style="color: red;">A senha tem que conter caracteres especiais(! @ # $ %)</span><br>`
        } if (senha.includes(`!`) || senha.includes(`@`) || senha.includes(`#`) || senha.includes(`$`) || senha.includes(`%`)) {
            p4.innerHTML = `<span style="color: green;">A senha tem que conter caracteres especiais(! @ # $ %)</span><br>`
        } if (!(senha.includes(`0`)) || !(senha.includes(`1`)) || !(senha.includes(`2`)) || !(senha.includes(`3`)) || !(senha.includes(`4`)) || !(senha.includes(`5`)) || !(senha.includes(`6`)) || !(senha.includes(`7`)) || !(senha.includes(`8`)) || !(senha.includes(`9`))) {
            p5.innerHTML = `<span style="color: red;">A senha tem que conter números</span><br>`
        } if (senha.includes(`0`) || senha.includes(`1`) || senha.includes(`2`) || senha.includes(`3`) || senha.includes(`4`) || senha.includes(`5`) || senha.includes(`6`) || senha.includes(`7`) || senha.includes(`8`) || senha.includes(`9`)) {
            p5.innerHTML = `<span style="color: green;">A senha tem que conter números</span><br>`
        }
    }
</script>

</html>

<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <title>Cadastro</title>

  <link rel="stylesheet" href="./css/cadastro.css" />
  <link rel="icon" href="./assets/imgs/logo png.png" />
</head>

<body>
     <header class="navbar">
        <img src="./assets/imgs/logo png.png" alt="logo" class="logoheader" />
        <div class="menu">
            <a href="index.html">
                <p>Início</p>
            </a>
            <a href="simulador.html">
                <p>Simulador</p>
            </a>
            <a href="sobreNos.html">
                <p>Sobre nós</p>
            </a>
        </div>
        <div class="cadastro">
            <a href="login.html">
                <p>Login</p>
            </a>
            <div class="c">
                <a href="cadastro.html">
                    <p class="cadastrar">Cadastro</p>
                </a>
            </div>
        </div>
    </header>

    <div class="conteudo">
        <div class="entradas">
            <h2>Cadastro</h2>
            <p>Codigo de ativação</p>
            <img src="./assets/imgs/codigo-de-barras.png" alt="" />
            <input type="text" id="iptCodigoAti" placeholder="ex: 45RT09" />
            <div id="msg"></div>
            <p>Nome</p>
            <img src="./assets/imgs/pessoa.png" alt="" />
            <input type="text" id="iptNome" placeholder="Ex: Cesar" />
            <div id="msg2"></div>
            <p>Email</p>
            <img src="./assets/imgs/o-email.png" alt="" />
            <input type="text" id="iptEmail" placeholder="Ex: agrosense@gmail.com" />
            <div id="msg3"></div>
            <p>Senha</p>
            <img src="./assets/imgs/cadeado-trancado.png" alt="imagem do cadeado" />
            <input type="password" id="iptSenha" onkeyup="mostrarSenha()" placeholder="Ex: @groSense123" />
            <div class="validacao">
                <p id="p1"></p>
                <p id="p2"></p>
                <p id="p3"></p>
                <p id="p4"></p>
                <p id="p5"></p>
            </div>
            <p>Confirmar Senha</p>
            <img src="./assets/imgs/cadeado-trancado.png" alt="imagem do cadeado" />
            <input type="password" id="iptCheckSenha" placeholder="Ex: @groSense123" />
            <div id="msg4"></div>
            <p>CPF</p>
            <img src="./assets/imgs/cpf.png" alt="" />
            <input type="number" id="iptCPF" placeholder="Ex: 32145698701" />
            <div id="msg6"></div>
            <p>Tipo de usuário</p>
            <select name="selectTipo" id="selecTipo">
                <option value="#">Selecione o tipo...</option>
                <option value="Admin">Admin</option>
                <option value="User">User</option>
            </select>
            <div id="msg7"></div>
            <div class="botao c">
                <button onclick="cadastrar()" class="botao">Cadastrar</button>
            </div>
        </div>
    </div>

    <footer class="rodape">
        <div class="rodape_bordao">
            <img src="./assets/imgs/logo branca.png" alt="logo" class="logofooter" />
            <p>Tecnologia que nasce da terra</p>
        </div>
        <div class="rodape_contato">
            <p>Contato</p>

            <div>
                <img src="./assets/imgs/whatsapp.png" alt="logoWhatsapp" />
                <a href=""><span>+55 (11) 9999-9999</span></a>
            </div>
            <div>
                <img src="./assets/imgs/email.png" alt="logoEmail" />
                <a href=""><span>agrosense@agrosense.com</span></a>
            </div>
        </div>
        <div class="rodape_redes">
            <p>Redes Sociais</p>
            <div>
                <img src="./assets/imgs/youtube.png" alt="logoYoutube" />
                <img src="./assets/imgs/instagram.png" alt="logoInstagram" />
                <img src="./assets/imgs/linkedin.png" alt="logoLinkedin" />
            </div>
        </div>
        <div class="rodape_empresas">
            <div>
                <p>Empresas Parceiras</p>
            </div>
            <div class="empresas">
                <a href="">
                    <p>Empresa Parceira 1</p>
                </a>
                <a href="">
                    <p>Empresa Parceira 2</p>
                </a>
                <a href="">
                    <p>Empresa Parceira 3</p>
                </a>
            </div>
        </div>
    </footer>
</body>

</html>

<script>

 function cadastrar() {
    
    var CodigoAtiVar = iptCodigoAti.value
    var nomeVar = iptNome.value;
    var emailVar = iptEmail.value;
    var senhaVar = iptSenha.value;
    var confirmarSenha = iptCheckSenha.value;
    var cpfVar = Number(iptCPF.value)
    var tipoVar = selecTipo.value
   mostrarSenha()

        msg.innerHTML = ''
        msg2.innerHTML = ''
        msg3.innerHTML = ''
        msg4.innerHTML = ''
        msg6.innerHTML = ''

        if (CodigoAtiVar == ``) {
            msg.innerHTML = `Preencha o campo Código de ativação`
        } if (nomeVar == ``) {
            msg2.innerHTML = `Preencha o campo nome`
        } if (emailVar == ``) {
            msg3.innerHTML = `Preencha o campo email`
        } if (confirmarSenha == ``) {
            msg4.innerHTML = `Preencha o campo Confirmar Senha`
        }if (cpfVar == 0) {
            msg6.innerHTML = `Preencha o campo CPF`
        }
        if (tipoVar == '#') {
            msg7.innerHTML = `Preencha o tipo de usuário`
        }
        else if (CodigoAtiVar.length > 6 || CodigoAtiVar.length < 6) {
            msg.innerHTML = 'O campo código de ativação tem que ter 6 dígitos!'
        }else if (cpfVar % 1 != 0 || cpfVar < 0 || cpfVar > 99999999999) {
            msg6.innerHTML = `No campo CPF não pode ser maior que 11 caracteres`
        } else if (cpfVar <= 11111111111) {
            msg6.innerHTML = 'No campo CPF não pode ser menor que 11 caracteres'
        } else if (!(emailVar.includes(`@`))) {
            msg3.innerHTML = `Seu email não contém "@"`
        } else if (!(emailVar.includes(`.`))) {
            msg3.innerHTML = `Seu email não contém "."`
        } else if (senhaVar.length < 8) {
            msg4.innerHTML = 'No campo senha tem que ter mais que 8 caracteres'
        } else if (senhaVar == senhaVar.toUpperCase()) {
            msg4.innerHTML = 'A senha não contém letras minúsculas'
        } else if (senhaVar == senhaVar.toLowerCase()) {
            msg4.innerHTML = 'A senha não contém letras maiúsculas'
        } else if (!(senhaVar.includes(`0`)) && !(senhaVar.includes(`1`)) && !(senhaVar.includes(`2`)) && !(senhaVar.includes(`3`)) && !(senhaVar.includes(`4`)) && !(senhaVar.includes(`5`)) && !(senhaVar.includes(`6`)) && !(senhaVar.includes(`7`)) && !(senhaVar.includes(`8`)) && !(senhaVar.includes(`9`))) {
            msg4.innerHTML = 'A senha tem que ter pelo menos um número (0 a 9)'
        } else if (!(senhaVar.includes(`!`)) && !(senhaVar.includes(`@`)) && !(senhaVar.includes(`#`)) && !(senhaVar.includes(`$`)) && !(senhaVar.includes(`%`))) {
            msg4.innerHTML = `A senha tem que ter pelo menos um caracter especial (!, @, #, $, %)`
        }
        else if (confirmarSenha != senhaVar) {
            msg4.innerHTML = `Verifique se as senhas estão iguais`
        } else {

            console.log(tipoVar)
            alert(`Cadastro efetuado com sucesso!! Agora faça seu login!!`)
            fetch("/usuarios/cadastrar", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                },
                body: JSON.stringify({
                    nomeServer: nomeVar,
                    emailServer: emailVar,
                    senhaServer: senhaVar,
                    cpfServer: cpfVar,
                    codigoAtivacaoServer: CodigoAtiVar,
                    tipoServer: tipoVar
                    
                }),
            })
                .then(function (resposta) {
                    console.log("resposta: ", resposta);

                    if (resposta.ok) {

                        setTimeout(() => {
                            window.location = "login.html";
                        }, "1000");

                    }
                })
        }
  }

  function mostrarSenha() {
        var senhaVar = iptSenha.value
        if (senhaVar.length < 8) {
            p1.innerHTML = `<span style="color: red;">A senha tem que conter pelo menos 8 caracteres</span><br>`
        } if (senhaVar.length >= 8) {
            p1.innerHTML = `<span style="color: green;">A senha tem que conter pelo menos 8 caracteres</span><br>`
        } if (senhaVar == senhaVar.toUpperCase()) {
            p2.innerHTML = `<span style="color: red;">A senha tem que conter letras minúsculas</span><br>`
        } if (senhaVar != senhaVar.toUpperCase()) {
            p2.innerHTML = `<span style="color: green;">A senha tem que conter letras minúsculas</span><br>`
        } if (senhaVar == senhaVar.toLowerCase()) {
            p3.innerHTML = `<span style="color: red;">A senha tem que conter letras maiúsculas</span><br>`
        } if (senhaVar != senhaVar.toLowerCase()) {
            p3.innerHTML = `<span style="color: green;">A senha tem que conter letras maiúsculas</span><br>`
        } if (!(senhaVar.includes(`!`)) || !(senhaVar.includes(`@`)) || !(senhaVar.includes(`#`)) || !(senhaVar.includes(`$`)) || !(senhaVar.includes(`%`))) {
            p4.innerHTML = `<span style="color: red;">A senha tem que conter caracteres especiais(! @ # $ %)</span><br>`
        } if (senhaVar.includes(`!`) || senhaVar.includes(`@`) || senhaVar.includes(`#`) || senhaVar.includes(`$`) || senhaVar.includes(`%`)) {
            p4.innerHTML = `<span style="color: green;">A senha tem que conter caracteres especiais(! @ # $ %)</span><br>`
        } if (!(senhaVar.includes(`0`)) || !(senhaVar.includes(`1`)) || !(senhaVar.includes(`2`)) || !(senhaVar.includes(`3`)) || !(senhaVar.includes(`4`)) || !(senhaVar.includes(`5`)) || !(senhaVar.includes(`6`)) || !(senhaVar.includes(`7`)) || !(senhaVar.includes(`8`)) || !(senhaVar.includes(`9`))) {
            p5.innerHTML = `<span style="color: red;">A senha tem que conter números</span><br>`
        } if (senhaVar.includes(`0`) || senhaVar.includes(`1`) || senhaVar.includes(`2`) || senhaVar.includes(`3`) || senhaVar.includes(`4`) || senhaVar.includes(`5`) || senhaVar.includes(`6`) || senhaVar.includes(`7`) || senhaVar.includes(`8`) || senhaVar.includes(`9`)) {
            p5.innerHTML = `<span style="color: green;">A senha tem que conter números</span><br>`
        }
    }

</script>
